(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{669:function(s,a,e){"use strict";e.r(a);var n=e(5),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("Jenkins 是一款开源自动化服务器，可用于轻松设置持续集成和持续交付（CI / CD）管道。")]),s._v(" "),e("p",[s._v("持续集成（CI）是DevOps的一种实践，团队成员定期将其代码更改提交到版本控制存储库，然后运行自动构建和测试。 持续交付（CD）是一系列的实践，代码更改会自动生成，测试并部署到生产中。")]),s._v(" "),e("p",[s._v("Jenkins可以作为独立应用程序安装，也可以作为Java servlet容器（例如 Apache Tomcat ）中的servlet安装，也可以作为Docker容器运行。")]),s._v(" "),e("p",[s._v("本文介绍了如何在Ubuntu 20.04上将Jenkins作为独立服务安装")]),s._v(" "),e("h1",{attrs:{id:"安装java"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装java"}},[s._v("#")]),s._v(" 安装Java")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openjdk-11-jdk\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("安装完成后，请检查Java版本:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("java -version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h1",{attrs:{id:"安装jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装jenkins"}},[s._v("#")]),s._v(" 安装Jenkins")]),s._v(" "),e("p",[s._v("在Ubuntu上安装Jenkins相对简单。 我们将启用Jenkins APT存储库，导入存储库GPG密钥，并安装Jenkins软件包。")]),s._v(" "),e("p",[s._v("使用以下 wget 命令导入Jenkins存储库的GPG密钥：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -q -O - https://pkg.jenkins.io/debian/jenkins.io.key "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("接下来，使用以下命令将Jenkins存储库添加到系统中：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启用Jenkins存储库后，通过输入以下命令更新apt包列表并安装最新版本的Jenkins:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" jenkins\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("如果收到错误消息：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v('Error: W: GPG error: https://pkg.jenkins.io/debian-stable binary/ Release: The following signatures couldn’t be verified because the public key is not available: NO_PUBKEY 9B7D32F2D50582E6"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("请将密钥导入：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 9B7D32F2D50582E6\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Jenkins服务将在安装过程完成后自动启动。 您可以通过打印服务状态进行验证：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl status jenkins\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("您应该看到类似以下的内容")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("● jenkins.service - LSB: Start Jenkins at boot "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("\n     Loaded: loaded "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/etc/init.d/jenkins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" generated"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     Active: active "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exited"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" since Thu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-07-16 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(":22:12 UTC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" 15min ago\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h1",{attrs:{id:"调整防火墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#调整防火墙"}},[s._v("#")]),s._v(" 调整防火墙")]),s._v(" "),e("p",[s._v("如果要在受防火墙保护的远程Ubuntu服务器上安装Jenkins，则需要打开端口8080。")]),s._v(" "),e("p",[s._v("通常，您只想允许从特定IP地址或IP范围访问Jenkins服务器。 例如，要仅允许来自“ 192.168.121.0/24”子网的连接，可以运行以下命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ufw allow proto tcp from "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".121.0/24 to any port "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果您需要允许从任何地方访问，请执行以下操作：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ufw allow "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h1",{attrs:{id:"设置jenkins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置jenkins"}},[s._v("#")]),s._v(" 设置Jenkins")]),s._v(" "),e("p",[s._v("要设置新安装的Jenkins，请打开浏览器，键入域或IP地址，然后输入端口8080，http://your_ip_or_domain:8080。")]),s._v(" "),e("p",[s._v("提示您输入在安装过程中创建的管理员密码：")]),s._v(" "),e("p",[s._v("使用 cat 在终端上显示密码：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/lib/jenkins/secrets/initialAdminPassword\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("您应该看到一个32个字符长的字母数字密码，如下所示：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("06cbf25d811a424bb236c76fd6e04c47\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("从终端复制密码，将其粘贴到“管理员密码”字段中，然后单击“继续”。")]),s._v(" "),e("p",[s._v("在下一个屏幕上，设置向导将询问您是否要安装建议的插件或要选择特定的插件。")]),s._v(" "),e("p",[s._v("点击“安装建议的插件Install suggested plugins”选项，安装过程将立即开始。")]),s._v(" "),e("p",[s._v("安装了插件后，系统将提示您设置第一个管理员用户。 填写所有必填信息，然后单击“保存并继续”。")]),s._v(" "),e("p",[s._v("下一页将要求您设置Jenkins实例的URL。 该字段将填充自动生成的网址。")]),s._v(" "),e("p",[s._v("通过单击Save and Finish按钮确认URL，然后完成设置过程。")]),s._v(" "),e("p",[s._v("单击Start using Jenkins按钮，您将被重定向到以您在前面的步骤之一中创建的admin用户身份登录的Jenkins仪表板。")]),s._v(" "),e("p",[s._v("至此，您已经在服务器上成功安装了Jenkins。")]),s._v(" "),e("h1",{attrs:{id:"修改jenkins配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改jenkins配置文件"}},[s._v("#")]),s._v(" 修改Jenkins配置文件")]),s._v(" "),e("p",[s._v("停止jenkins")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl stop jenkins\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"上传自定义的-ca-证书"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#上传自定义的-ca-证书"}},[s._v("#")]),s._v(" 上传自定义的 ca 证书")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/jenkins/update-center-rootCAs\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://cdn.jsdelivr.net/gh/lework/jenkins-update-center/rootCA/update-center.crt -O /opt/jenkins/update-center-rootCAs/update-center.crt\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" root.root -R /opt/jenkins/update-center-rootCAs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"修改默认执行用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改默认执行用户"}},[s._v("#")]),s._v(" 修改默认执行用户")]),s._v(" "),e("p",[s._v("最近在需要在jenkins执行shell脚本，由于Jenkins之前是默认在线安装的，这样jenkins设置了默认用户jenkins权限\n如果要执行root用户命令，则报权限错误")]),s._v(" "),e("p",[s._v("所以要更换jenkins为root用户\n改变步骤如下：\n首先查找在线安装jenkins的目录, 然后执行")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / -name "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jenkins"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("编辑文件 /etc/default/jenkins")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/default/jenkins\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JENKINS_USER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JENKINS_GROUP")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"修改jenkins默认工作空间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改jenkins默认工作空间"}},[s._v("#")]),s._v(" 修改jenkins默认工作空间")]),s._v(" "),e("p",[s._v("在"),e("code",[s._v("/etc/profile")]),s._v("文件最后添加JENKINS_HOME")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"export JENKINS_HOME=/opt/jenkins"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/profile\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /etc/profile\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("重新启动jenkins服务")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl start jenkins\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("确认结果")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("执行jenkins的用户变成了root")]),s._v(" "),e("p",[s._v("启动网页确认工作空间。")]),s._v(" "),e("h2",{attrs:{id:"修改插件下载地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改插件下载地址"}},[s._v("#")]),s._v(" 修改插件下载地址")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("https://cdn.jsdelivr.net/gh/lework/jenkins-update-center/updates/huawei/update-center.json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);